(this.webpackJsonpstrangers_things_2=this.webpackJsonpstrangers_things_2||[]).push([[0],{35:function(e,t,n){"use strict";n.r(t);var s=n(7),r=n(3),c=n(1),a=n(17),o=n.n(a),i=n(6),u=n(4),l=n(2),j=n.n(l),p=n(5),b="https://strangers-things.herokuapp.com/api/2107-CSU-RM-WEB-PT",h=n(0);function d(){return(d=Object(p.a)(j.a.mark((function e(t,n,s,r){var c,a,o;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(b+"/users/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:{username:t,password:n}})});case 2:return c=e.sent,e.next=5,c.json();case 5:a=e.sent,console.log(a),o=a.data.token,s(o),localStorage.setItem("token",o),r.push("/");case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(){return(O=Object(p.a)(j.a.mark((function e(t,n,s,r){var c,a,o;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s===r){e.next=3;break}return alert("Passwords don't match"),e.abrupt("return");case 3:return e.next=5,fetch(b+"/users/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:{username:n,password:s}})});case 5:return c=e.sent,e.next=8,c.json();case 8:a=e.sent,console.log(a),o=a.data.token,t(o),localStorage.setItem("token",o);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var f=function(e){var t=e.setToken,n=e.match,s=e.history,a=Object(c.useState)("your username"),o=Object(r.a)(a,2),u=o[0],l=o[1],j=Object(c.useState)("your password"),p=Object(r.a)(j,2),b=p[0],f=p[1],x=Object(c.useState)(""),m=Object(r.a)(x,2),v=m[0],g=m[1];return Object(h.jsxs)("form",{onSubmit:function(e){e.preventDefault(),"/login"===n.url&&function(e,t,n,s){d.apply(this,arguments)}(u,b,t,s),"/register"===n.url&&function(e,t,n,s){O.apply(this,arguments)}(t,u,b,v)},children:[Object(h.jsxs)("div",{className:"container",children:[Object(h.jsx)("label",{className:"form-label",children:"Username"}),Object(h.jsx)("input",{type:"text",value:u,onChange:function(e){var t=e.target.value;return l(t)},className:"form-control",id:"usernameInput",placeholder:"your username here"})]}),Object(h.jsxs)("div",{className:"container",children:[Object(h.jsx)("label",{className:"form-label",children:"Password"}),Object(h.jsx)("input",{type:"password",value:b,onChange:function(e){var t=e.target.value;return f(t)},className:"form-control",id:"passwordInput",placeholder:"your password here"})]}),"/register"===n.url?Object(h.jsxs)("div",{className:"container",children:[Object(h.jsx)("label",{className:"form-label",children:"Confirm Password"}),Object(h.jsx)("input",{type:"password",onChange:function(e){var t=e.target.value;return g(t)},value:v,className:"form-control",id:"setConfirmPasswordInput",placeholder:""})]}):null,Object(h.jsxs)("div",{className:"submit",children:[Object(h.jsx)("button",{type:"submit",className:"submit-button",children:"Submit"}),"/register"===n.url?Object(h.jsx)(i.b,{to:"/login",children:" Already have an account? "}):Object(h.jsx)(i.b,{to:"/register",children:" Don't have an account?"})]})]})};function x(e){return!!e}function m(e,t){return v.apply(this,arguments)}function v(){return(v=Object(p.a)(j.a.mark((function e(t,n){var s,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(b+"/users/me",{headers:{"Content-Type":"application/json",Authorization:"Bearer "+t}});case 3:return s=e.sent,e.next=6,s.json();case 6:return r=e.sent,console.log(r),n[r.data.username],e.abrupt("return",r);case 12:e.prev=12,e.t0=e.catch(0),console.error(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)}function g(e,t){return y.apply(this,arguments)}function y(){return(y=Object(p.a)(j.a.mark((function e(t,n){var s,r,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://strangers-things.herokuapp.com/api/2107-CSU-RM-WEB-PT/posts",{headers:L(t)});case 3:return s=e.sent,e.next=6,s.json();case 6:r=e.sent,c=r.data.posts,n(c),console.log("data: ",r.data.posts),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.error(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)}function k(e,t,n,s,r,c){return w.apply(this,arguments)}function w(){return(w=Object(p.a)(j.a.mark((function e(t,n,s,r,c,a){var o,i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(b+"/posts",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t},body:JSON.stringify({post:{title:n,description:s,price:r,location:c,willDeliver:a}})});case 3:return o=e.sent,e.next=6,o.json();case 6:return i=e.sent,e.abrupt("return",i);case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}function S(e,t){return P.apply(this,arguments)}function P(){return(P=Object(p.a)(j.a.mark((function e(t,n){var s,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(b,"/posts/").concat(n),{method:"DELETE",headers:L(t)});case 3:return s=e.sent,e.next=6,s.json();case 6:return r=e.sent,e.abrupt("return",r);case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}function C(e,t){return N.apply(this,arguments)}function N(){return(N=Object(p.a)(j.a.mark((function e(t,n){var s,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(b,"/posts/").concat(n,"/messages"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t},body:JSON.stringify({message:{content:"content"}})});case 3:return s=e.sent,e.next=6,s.json();case 6:return r=e.sent,e.abrupt("return",r);case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}function T(e,t){return D.apply(this,arguments)}function D(){return(D=Object(p.a)(j.a.mark((function e(t,n){var s,r,c,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(b,"/posts"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}});case 3:return s=e.sent,e.next=6,s.json();case 6:return r=e.sent,c=r.data.posts,a=c.find((function(e){if(e._id===n)return console.log(e),e})),console.log(a),e.abrupt("return",a);case 13:e.prev=13,e.t0=e.catch(0),console.error("Isssue Fetching Users Posts",e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})))).apply(this,arguments)}function L(e){var t={"Content-Type":"application/json"};return e&&(t.Authorization="Bearer "+e),t}var E=function(e){var t=e.token,n=Object(c.useState)([]),s=Object(r.a)(n,2),a=s[0],o=s[1],u=Object(c.useState)([]),l=Object(r.a)(u,2),b=l[0],d=l[1];return Object(c.useEffect)(Object(p.a)(j.a.mark((function e(){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=7;break}return e.next=3,m(t,o);case 3:n=e.sent,console.log("userdata.data",n.data),o(n.data),d(n.data.messages);case 7:case"end":return e.stop()}}),e)}))),[t]),t?Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("div",{className:"centered",children:[Object(h.jsxs)("h1",{children:[" Welcome back, ",a.username,"!"]}),Object(h.jsx)("h3",{children:"Inbox:"}),b.map((function(e,t){if(a.username!==e.fromUser.username)return Object(h.jsx)("div",{children:Object(h.jsxs)("ul",{children:[Object(h.jsx)("ul",{children:Object(h.jsxs)("h4",{children:["Post: ",e.post.title]})}),Object(h.jsxs)("ul",{children:["Sender: ",e.fromUser.username]}),Object(h.jsxs)("ul",{children:["Message: ",e.content]})]})},t)}))]}),Object(h.jsxs)("div",{children:[Object(h.jsx)("h3",{children:"Sent Messages: "}),b.map((function(e,t){if(a.username===e.fromUser.username)return Object(h.jsx)("div",{children:Object(h.jsxs)("ul",{children:[Object(h.jsx)("ul",{children:Object(h.jsxs)("h4",{children:["Post: ",e.post.title]})}),Object(h.jsx)("ul",{children:"Sender: Me "}),Object(h.jsxs)("ul",{children:["Message: ",e.content]})]})},t)}))]})]}):Object(h.jsxs)("h3",{children:["Please ",Object(h.jsx)(i.b,{to:"/login",children:"login "}),"to view your profile"]})};var I=function(e){var t=e.token,n=e.setPosts,s=Object(c.useState)(""),a=Object(r.a)(s,2),o=a[0],i=(a[1],Object(c.useState)([])),u=Object(r.a)(i,2),l=u[0],j=u[1];return Object(c.useEffect)((function(){g(t,n)}),[t,n]),Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("form",{children:Object(h.jsx)("div",{children:Object(h.jsx)("input",{type:"text",value:o,onChange:function(e){var t=e.target.value,n=posts.filter((function(e){return function(e,t){e.title.toLowerCase().includes(t),e.description.toLowerCase().includes(t),e.author.username.toLowerCase().includes(t),e.price.toLowerCase().includes(t),e.location.toLowerCase().includes(t)}(e,t.toLowerCase())})),s=t.length?n:posts;j(s)}})})}),l.map((function(e,t){return Object(h.jsx)("div",{children:Object(h.jsx)("div",{className:"displayPostTitle",children:e.title})},t)}))]})},M=function(e){var t=e.token,n=e.postsDisplay,s=e.setPostsDisplay,a=Object(c.useState)([]),o=Object(r.a)(a,2),i=o[0],l=o[1],b=Object(u.e)();return console.log("posts: ",i),Object(c.useEffect)((function(){g(t,l)}),[t]),Object(h.jsxs)("div",{children:[Object(h.jsxs)("div",{children:[Object(h.jsxs)("span",{className:"searchbar",children:["Search Listings: ",Object(h.jsx)(I,{postsDisplay:n,setPostsDisplay:s})]}),Object(h.jsx)("h2",{children:"Current Listings"})]}),Object(h.jsx)("ul",{className:"otherPosts",children:i.map((function(e,n){return Object(h.jsxs)("div",{children:[Object(h.jsx)("h3",{children:e.title}),Object(h.jsxs)("p",{children:["Description: ",e.description]}),Object(h.jsxs)("li",{children:["Price: ",e.price]}),Object(h.jsxs)("li",{children:["Seller: ",e.author.username]}),t?Object(h.jsx)("ul",{children:e.isAuthor?Object(h.jsx)("button",{onClick:Object(p.a)(j.a.mark((function n(){var s;return j.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e._id,n.next=3,S(t,e._id);case 3:s=n.sent,alert("Delete ".concat(s.success?"successful!":"unsuccessful - try again!")),backToProfile();case 6:case"end":return n.stop()}}),n)}))),className:"deleteButton",children:"Delete"}):Object(h.jsx)("button",{onClick:Object(p.a)(j.a.mark((function t(){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:b.push("/singlepost/".concat(e._id));case 1:case"end":return t.stop()}}),t)}))),className:"toSinglePost",children:"Send Message"})}):null]},n)}))})]})},F=n(20),U=function(e){var t=e.token,n=e.setPosts,s=e.posts,a=Object(c.useState)(""),o=Object(r.a)(a,2),l=o[0],b=o[1],d=Object(c.useState)(""),O=Object(r.a)(d,2),f=O[0],x=O[1],m=Object(c.useState)(""),v=Object(r.a)(m,2),g=v[0],y=v[1],w=Object(c.useState)(""),S=Object(r.a)(w,2),P=S[0],C=S[1],N=Object(c.useState)(!1),T=Object(r.a)(N,2),D=T[0],L=T[1],E=Object(u.e)();return t?Object(h.jsxs)("article",{className:"newPostArticle",children:[Object(h.jsx)("h3",{children:"Create New Listing"}),Object(h.jsxs)("form",{onSubmit:function(){var e=Object(p.a)(j.a.mark((function e(r){var c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),e.prev=1,e.next=4,k(t,l,f,g,P,D);case 4:c=e.sent,n([].concat(Object(F.a)(s),[c])),alert("Post ".concat(c.success?"successful!":"unsuccessful - try again!")),E.push("/posts"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}(),children:[Object(h.jsx)("label",{htmlFor:"postTitle",children:"Post Title:"}),Object(h.jsx)("input",{type:"text",value:l,onChange:function(e){var t=e.target.value;return b(t)},className:"form-control",id:"postTitle",placeholder:"title"}),Object(h.jsx)("label",{htmlFor:"postDescrip",children:"Description:"}),Object(h.jsx)("input",{type:"text",value:f,onChange:function(e){var t=e.target.value;return x(t)},className:"form-control",id:"postDescrip",placeholder:"description"}),Object(h.jsx)("label",{htmlFor:"postPrice",children:"Price:"}),Object(h.jsx)("input",{type:"text",value:g,onChange:function(e){var t=e.target.value;return y(t)},className:"form-control",id:"postPrice",placeholder:"price"}),Object(h.jsx)("label",{htmlFor:"postLocation",children:"Location:"}),Object(h.jsx)("input",{type:"text",value:P,onChange:function(e){var t=e.target.value;return C(t)},className:"form-control",id:"postLocation",placeholder:"location"}),Object(h.jsxs)("div",{children:[Object(h.jsx)("label",{htmlFor:"postDeliver",children:"Willing to Deliver?"}),Object(h.jsx)("input",{type:"checkbox",value:D,onChange:function(e){e.target.value;return L(!D)},id:"postDeiver"})]}),Object(h.jsx)("button",{className:"submitNewPost",children:"Submit"})]})]}):Object(h.jsxs)("h3",{children:["Please ",Object(h.jsx)(i.b,{to:"/login",children:"login "}),"to create a new listing."]})},A=function(e){var t=e.token,n=(e.match,e.onePost),s=e.setOnePost,a=Object(u.f)().postID,o=Object(c.useState)(""),i=Object(r.a)(o,2),l=i[0],b=i[1];return Object(c.useEffect)(Object(p.a)(j.a.mark((function e(){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(a),e.next=3,T(t,a);case 3:n=e.sent,console.log("this is the post:",n),s(n);case 6:case"end":return e.stop()}}),e)}))),[]),Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("div",{children:[Object(h.jsx)("h3",{children:n.title}),Object(h.jsx)("h5",{children:n.description}),Object(h.jsx)("h4",{children:n.price})]}),t?Object(h.jsxs)("form",{onSubmit:function(){var e=Object(p.a)(j.a.mark((function e(n){var s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,C(t,a,l);case 3:s=e.sent,alert("Message ".concat(s.success?"sent":"not sent")),b("");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),children:[Object(h.jsx)("textarea",{type:"text",placeholder:"your message here",autoFocus:!0,required:!0,id:"message",value:l,onChange:function(e){var t=e.target.value;return b(t)}}),Object(h.jsx)("p",{children:Object(h.jsx)("button",{className:"sendMessage",children:"Send Message"})})]}):Object(h.jsx)("h3",{children:"Please login or create an account to message seller."})]})},B=function(){var e=Object(c.useState)(localStorage.getItem("token")),t=Object(r.a)(e,2),n=t[0],a=t[1],o=Object(c.useState)(""),l=Object(r.a)(o,2),j=l[0],p=l[1],b=Object(c.useState)([]),d=Object(r.a)(b,2),O=d[0],m=d[1],v=Object(c.useState)({}),g=Object(r.a)(v,2),y=g[0],k=g[1],w=Object(c.useState)(x(n)),S=Object(r.a)(w,2),P=S[0],C=S[1];return Object(c.useEffect)((function(){C(x(n))}),[n]),Object(c.useEffect)((function(){console.log("Mounted"),n&&m(O)}),[n]),Object(h.jsx)(i.a,{children:Object(h.jsxs)("div",{id:"container",children:[Object(h.jsx)("div",{id:"title",children:Object(h.jsx)(i.b,{to:"/profile",children:"STRANGERS' THINGS"})}),Object(h.jsxs)("div",{id:"navbar",children:[Object(h.jsx)(i.b,{to:"/login",children:" Login "}),Object(h.jsx)(i.b,{to:"/register",children:" Register "}),Object(h.jsx)("span",{id:"logoutbutton",onClick:function(){alert("See you next time!"),function(e){localStorage.removeItem("token"),e(null)}(a)},children:" Logout "}),Object(h.jsxs)("p",{children:[Object(h.jsx)(i.b,{to:"/profile",children:" Profile "}),Object(h.jsx)(i.b,{to:"/posts",children:" Listings   "}),Object(h.jsx)(i.b,{to:"/makepost",children:" Create New "})]})]}),Object(h.jsx)(u.a,{path:"/posts",render:function(e){return Object(h.jsx)(M,Object(s.a)(Object(s.a)({},e),{},{loggedIn:P,token:n,setToken:a,setPosts:m,posts:O}))}}),Object(h.jsx)(u.a,{path:"/makepost",render:function(e){return Object(h.jsx)(U,Object(s.a)(Object(s.a)({},e),{},{token:n,setToken:a,setPosts:m,posts:O}))}}),Object(h.jsx)(u.a,{path:"/login",render:function(e){return Object(h.jsx)(f,Object(s.a)(Object(s.a)({},e),{},{setToken:a,setUser:p}))}}),Object(h.jsx)(u.a,{path:"/register",render:function(e){return Object(h.jsx)(f,Object(s.a)(Object(s.a)({},e),{},{setToken:a,setUser:p}))}}),Object(h.jsx)(u.a,{path:"/profile",render:function(e){return Object(h.jsx)(E,Object(s.a)(Object(s.a)({},e),{},{token:n,setUser:p,user:j}))}}),Object(h.jsx)(u.a,{path:"/singlepost/:postID",render:function(e){return Object(h.jsx)(A,Object(s.a)(Object(s.a)({},e),{},{token:n,setToken:a,onePost:y,setOnePost:k}))}}),Object(h.jsx)(u.a,{exact:!0,path:"/",render:function(e){return n?Object(h.jsx)(E,Object(s.a)(Object(s.a)({},e),{},{token:n,setToken:a,user:j})):Object(h.jsx)(f,Object(s.a)(Object(s.a)({},e),{},{setToken:a}))}})]})})};o.a.render(Object(h.jsx)(B,{}),document.getElementById("app"))}},[[35,1,2]]]);
//# sourceMappingURL=main.92720955.chunk.js.map